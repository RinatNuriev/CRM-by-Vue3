"use strict";(self["webpackChunkvue_crm"]=self["webpackChunkvue_crm"]||[]).push([[985],{1985:function(t,e,i){i.r(e),i.d(e,{default:function(){return X}});var s=i(6252);const l=(0,s._)("div",{class:"page-title"},[(0,s._)("h3",null,"Категории")],-1),a={key:1,class:"row"},n={key:1,class:"center"};function r(t,e,i,r,d,u){const o=(0,s.up)("loader"),c=(0,s.up)("category-create"),m=(0,s.up)("category-edit");return(0,s.wg)(),(0,s.iD)("div",null,[l,(0,s._)("section",null,[t.loading?((0,s.wg)(),(0,s.j4)(o,{key:0})):((0,s.wg)(),(0,s.iD)("div",a,[(0,s.Wm)(c,{onCreated:u.addNewCategory},null,8,["onCreated"]),t.categories.length?((0,s.wg)(),(0,s.j4)(m,{categories:t.categories,key:t.categories.length+t.updateCount,onUpdated:u.updateCategories},null,8,["categories","onUpdated"])):((0,s.wg)(),(0,s.iD)("p",n,"Категорий пока нет"))]))])])}i(7658);var d=i(9963),u=i(3577);const o={class:"col s12 m6"},c=(0,s._)("div",{class:"page-subtitle"},[(0,s._)("h4",null,"Создать")],-1),m={class:"input-field"},h=(0,s._)("label",{for:"name"},"Название",-1),g={class:"input-field"},v=(0,s._)("label",{for:"limit"},"Лимит",-1),p=(0,s._)("button",{class:"btn waves-effect waves-light",type:"submit"},[(0,s.Uk)(" Создать "),(0,s._)("i",{class:"material-icons right"},"send")],-1);function w(t,e,i,l,a,n){return(0,s.wg)(),(0,s.iD)("div",o,[(0,s._)("div",null,[c,(0,s._)("form",{onSubmit:e[2]||(e[2]=(0,d.iM)(((...t)=>n.submitHandler&&n.submitHandler(...t)),["prevent"]))},[(0,s._)("div",m,[(0,s.wy)((0,s._)("input",{id:"name",type:"text","onUpdate:modelValue":e[0]||(e[0]=e=>t.title=e),class:(0,u.C_)({invalid:t.v$.title.dirty&&!t.v$.title.required})},null,2),[[d.nr,t.title]]),h,((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(t.v$.title.$errors,(t=>((0,s.wg)(),(0,s.iD)("span",{class:"helper-text invalid",key:t.$uid},(0,u.zw)(t.$message),1)))),128))]),(0,s._)("div",g,[(0,s.wy)((0,s._)("input",{id:"limit",type:"number","onUpdate:modelValue":e[1]||(e[1]=e=>t.limit=e),class:(0,u.C_)({invalid:t.v$.title.dirty&&!t.v$.title.minValue})},null,2),[[d.nr,t.limit,void 0,{number:!0}]]),v,((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(t.v$.limit.$errors,(t=>((0,s.wg)(),(0,s.iD)("span",{class:"helper-text invalid",key:t.$uid},(0,u.zw)(t.$message),1)))),128))]),p],32)])])}var $=i(4028),y=i(2587),_=i(3058),f=i.n(_),b={setup:()=>({v$:(0,$.Xw)()}),data:()=>({title:"",limit:100}),validations:{title:{required:y.BM.withMessage("Введите название категории",y.C1)},limit:{required:y.BM.withMessage("Укажите сумму",y.C1),minValue:y.BM.withMessage((({$params:t})=>`Минимальная величина - ${t.min}`),(0,y.uv)(100))}},methods:{async submitHandler(){if(this.v$.$invalid)this.v$.$touch();else try{const t=await this.$store.dispatch("createCategory",{title:this.title,limit:this.limit});this.title="",this.limit=100,this.v$.$reset(),this.$message("Категория была создана"),this.$emit("created",t)}catch(t){t.message}}},mounted(){f().updateTextFields()}},C=i(3744);const k=(0,C.Z)(b,[["render",w]]);var D=k;const M={class:"col s12 m6"},H=(0,s._)("div",{class:"page-subtitle"},[(0,s._)("h4",null,"Редактировать")],-1),x={class:"input-field"},U=["value"],V=(0,s._)("label",null,"Выберите категорию",-1),q={class:"input-field"},B=(0,s._)("label",{for:"name"},"Название",-1),z={class:"input-field"},K=(0,s._)("label",{for:"limit"},"Лимит",-1),Y=(0,s._)("button",{class:"btn waves-effect waves-light",type:"submit"},[(0,s.Uk)(" Обновить "),(0,s._)("i",{class:"material-icons right"},"send")],-1);function Z(t,e,i,l,a,n){return(0,s.wg)(),(0,s.iD)("div",M,[(0,s._)("div",null,[H,(0,s._)("form",{onSubmit:e[3]||(e[3]=(0,d.iM)(((...t)=>n.submitHandler&&n.submitHandler(...t)),["prevent"]))},[(0,s._)("div",x,[(0,s.wy)((0,s._)("select",{ref:"select","onUpdate:modelValue":e[0]||(e[0]=t=>a.current=t)},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(i.categories[0],(t=>((0,s.wg)(),(0,s.iD)("option",{key:t.id,value:t.id},(0,u.zw)(t.title),9,U)))),128))],512),[[d.bM,a.current]]),V]),(0,s._)("div",q,[(0,s.wy)((0,s._)("input",{id:"name",type:"text","onUpdate:modelValue":e[1]||(e[1]=t=>a.title=t),class:(0,u.C_)({invalid:t.v$.title.dirty&&!t.v$.title.required})},null,2),[[d.nr,a.title]]),B,((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(t.v$.title.$errors,(t=>((0,s.wg)(),(0,s.iD)("span",{class:"helper-text invalid",key:t.$uid},(0,u.zw)(t.$message),1)))),128))]),(0,s._)("div",z,[(0,s.wy)((0,s._)("input",{id:"limit",type:"number","onUpdate:modelValue":e[2]||(e[2]=t=>a.limit=t),class:(0,u.C_)({invalid:t.v$.title.dirty&&!t.v$.title.minValue})},null,2),[[d.nr,a.limit,void 0,{number:!0}]]),K,((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(t.v$.limit.$errors,(t=>((0,s.wg)(),(0,s.iD)("span",{class:"helper-text invalid",key:t.$uid},(0,u.zw)(t.$message),1)))),128))]),Y],32)])])}var F={setup:()=>({v$:(0,$.Xw)()}),data(){return{select:"A",title:"",limit:100,current:null}},validations:{title:{required:y.BM.withMessage("Введите название категории",y.C1)},limit:{required:y.BM.withMessage("Укажите сумму",y.C1),minValue:y.BM.withMessage((({$params:t})=>`Минимальная величина - ${t.min}`),(0,y.uv)(100))}},props:{categories:{type:Array,required:!0}},mounted(){f().updateTextFields(),setTimeout((()=>{this.select=f().FormSelect.init(this.$refs.select,{})}),0)},unmounted(){this.select&&this.select.destroy&&this.select.destroy()},watch:{current(t){const{title:e,limit:i}=this.categories[0].find((e=>e.id===t));this.title=e,this.limit=i}},created(){const{id:t,title:e,limit:i}=this.categories[0][0];this.current=t,this.title=e,this.limit=i},methods:{async submitHandler(){if(this.v$.$invalid)this.v$.$touch();else try{const t={id:this.current,title:this.title,limit:this.limit};await this.$store.dispatch("updateCategory",t),this.$message("Категория обновлена"),this.$emit("updated",t)}catch(t){t.message}}}};const S=(0,C.Z)(F,[["render",Z]]);var T=S,j=i(4667),A={name:"categories",components:{CategoryCreate:D,CategoryEdit:T,Loader:j.Z},data:()=>({categories:[],loading:!0,updateCount:0}),methods:{addNewCategory(t){this.categories.push(t)},updateCategories(t){const e=this.categories[0].findIndex((e=>e.id===t.id));this.categories[0][e].title=t.title,this.categories[0][e].limit=t.limit,this.updateCount++}},async mounted(){this.categories=await this.$store.dispatch("fetchCategories"),this.loading=!1}};const N=(0,C.Z)(A,[["render",r]]);var X=N}}]);
//# sourceMappingURL=985.fbd3d870.js.map