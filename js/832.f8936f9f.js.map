{"version":3,"file":"js/832.f8936f9f.js","mappings":"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","sources":["webpack://vue-crm/./src/views/Record.vue","webpack://vue-crm/./src/views/Record.vue?707c"],"sourcesContent":["<template>\r\n    <div>\r\n            <div class=\"page-title\">\r\n              <h3>Новая запись</h3>\r\n            </div>\r\n\r\n            <loader v-if=\"loading\" />\r\n\r\n            <p class=\"center\" v-else-if=\"!categories.length\">Категорий пока нет <router-link to=\"/categories\">Добавить категорию</router-link> </p>\r\n\r\n            <form class=\"form\" v-else @submit.prevent=\"submitHandler\">\r\n              <div class=\"input-field\">\r\n                <select ref=\"select\" v-model=\"category\">\r\n                  <option \r\n                    v-for=\"cat in categories[0]\"\r\n                    :key=\"cat.id\"\r\n                    :value=\"cat.id\"\r\n                  >{{ cat.title }}</option>\r\n                </select>\r\n                <label>Выберите категорию</label>\r\n              </div>\r\n\r\n              <p>\r\n                <label>\r\n                  <input class=\"with-gap\" name=\"type\" type=\"radio\" value=\"income\" v-model=\"type\"/>\r\n                  <span>Доход</span>\r\n                </label>\r\n              </p>\r\n\r\n              <p>\r\n                <label>\r\n                  <input class=\"with-gap\" name=\"type\" type=\"radio\" value=\"outcome\" v-model=\"type\"/>\r\n                  <span>Расход</span>\r\n                </label>\r\n              </p>\r\n\r\n              <div class=\"input-field\">\r\n                <input id=\"amount\" type=\"number\" v-model.number=\"amount\"\r\n                :class=\"{\r\n                            invalid:\r\n                            v$.amount.dirty && !v$.amount.minValue\r\n                            \r\n                          }\"\r\n                >\r\n                <label for=\"amount\">Сумма</label>\r\n                <span class=\"helper-text invalid\"\r\n                v-for=\"error of v$.amount.$errors\"\r\n                                :key=\"error.$uid\">\r\n              \r\n                                {{ error.$message }}\r\n                \r\n                </span>\r\n              </div>\r\n\r\n              <div class=\"input-field\">\r\n                <input id=\"description\" type=\"text\" v-model=\"description\"\r\n                :class=\"{\r\n                            invalid:\r\n                            v$.description.dirty && !v$.description.required\r\n                          }\"\r\n                >\r\n                <label for=\"description\">Описание</label>\r\n                <span class=\"helper-text invalid\" v-for=\"error of v$.description.$errors\"\r\n                                :key=\"error.$uid\">\r\n              \r\n                                {{ error.$message }}</span> \r\n              </div>\r\n\r\n              <button class=\"btn waves-effect waves-light\" type=\"submit\">\r\n                Создать\r\n                <i class=\"material-icons right\">send</i>\r\n              </button>\r\n            </form>\r\n          </div>\r\n</template>\r\n\r\n<script>\r\nimport { useVuelidate } from \"@vuelidate/core\";\r\nimport { required, minValue, helpers } from \"@vuelidate/validators\";\r\n\r\nimport M from '../../node_modules/materialize-css/dist/js/materialize.min.js'\r\nimport Loader from '@/components/app/Loader.vue';\r\n\r\nimport { mapGetters } from 'vuex'\r\n\r\n\r\nexport default {\r\n  name: 'record',\r\n  data(){\r\n    return {\r\n      loading: true,\r\n      select: null,\r\n      categories: [],\r\n      type: 'outcome',\r\n      amount: 1,\r\n      description: '',\r\n      category: null\r\n    }\r\n  },\r\n  setup: () => {\r\n    return { v$: useVuelidate() };\r\n    },\r\n  validations: {\r\n        description: {required: helpers.withMessage('Введите название', required)},\r\n        amount: {\r\n            required: helpers.withMessage(\"Укажите сумму\", required),\r\n            minValue: helpers.withMessage(\r\n          ({ $params }) =>\r\n            `Минимальная величина - ${$params.min}`,\r\n          minValue(1)\r\n        )}\r\n    },\r\n  \r\n  async mounted() {\r\n   \r\n    this.categories = await this.$store.dispatch('fetchCategories')\r\n    this.loading = false\r\n\r\n    if(this.categories.length) {\r\n      this.category = this.categories[0][0].id\r\n    }\r\n\r\n    setTimeout(() => {\r\n      this.select = M.FormSelect.init(this.$refs.select, {})\r\n      M.updateTextFields()\r\n    }, 0);\r\n    \r\n  },\r\n  unmounted() {\r\n    if(this.select && this.select.destroy) {\r\n      this.select.destroy()\r\n    }\r\n  },\r\n  components: {\r\n    Loader\r\n  },\r\n  methods: {\r\n        async submitHandler() {\r\n            if (this.v$.$invalid) {\r\n                this.v$.$touch();\r\n                return;\r\n            }\r\n\r\n            if(this.canCreateRecord) {\r\n              try {\r\n                await this.$store.dispatch('createRecord', {\r\n                    categoryId: this.category,\r\n                    amount: this.amount,\r\n                    description: this.description,\r\n                    type: this.type,\r\n                    date: new Date().toJSON()\r\n              })\r\n\r\n                const bill = this.type === 'income' ? this.info.bill + this.amount : this.info.bill - this.amount\r\n              \r\n                await this.$store.dispatch('unpdateInfo', {bill})\r\n                this.$message('Запись успешно добавлена')\r\n                this.v$.$reset()\r\n                this.amount = 1\r\n                this.description = ''\r\n\r\n              } catch (error) {\r\n                error.message\r\n              }\r\n\r\n            } else {\r\n              this.$message(`Недостаточно средств на счете (${this.amount - this.info.bill})`)\r\n            }\r\n\r\n            \r\n        }\r\n    },\r\n    computed: {\r\n       ...mapGetters(['info']),\r\n\r\n       canCreateRecord () {\r\n        if(this.type === 'income') {\r\n          return true\r\n        }\r\n\r\n        return this.info.bill >= this.amount\r\n      }\r\n    },\r\n    \r\n}\r\n</script>","import { render } from \"./Record.vue?vue&type=template&id=19a79388\"\nimport script from \"./Record.vue?vue&type=script&lang=js\"\nexport * from \"./Record.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"C:\\\\Users\\\\justi\\\\OneDrive\\\\Рабочий стол\\\\vue-crm\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["_createElementVNode","class","for","type","_createElementBlock","_hoisted_1","$data","loading","_createBlock","_component_loader","key","categories","length","onSubmit","_cache","_withModifiers","args","$options","submitHandler","_hoisted_3","ref","category","$event","_Fragment","_renderList","cat","id","value","title","_hoisted_4","_hoisted_5","name","_hoisted_6","_hoisted_7","_hoisted_8","amount","_normalizeClass","_ctx","v$","dirty","minValue","_hoisted_9","$errors","error","$uid","$message","_hoisted_10","description","required","_hoisted_11","_hoisted_12","_hoisted_2","_createVNode","_component_router_link","to","data","select","setup","useVuelidate","validations","helpers","$params","min","async","this","$store","dispatch","setTimeout","M","$refs","unmounted","destroy","components","Loader","methods","$invalid","$touch","canCreateRecord","categoryId","date","Date","toJSON","bill","info","$reset","message","computed","mapGetters","__exports__","render"],"sourceRoot":""}