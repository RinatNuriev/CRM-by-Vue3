{"version":3,"file":"js/918.0681a87b.js","mappings":"2LAEiBA,MAAM,c,GACTC,EAAAA,EAAAA,GAAqB,UAAjB,gBAAY,G,SAKfD,MAAM,U,aAOAA,MAAM,Y,qHAdvBE,EAAAA,EAAAA,IAmBY,aAlBJD,EAAAA,EAAAA,GAGM,MAHNE,EAGM,CAFJC,GACAH,EAAAA,EAAAA,GAAwC,WAAAI,EAAAA,EAAAA,IAAjCC,EAAAC,eAAeC,EAAAC,KAAKC,OAAI,KAGnBC,EAAAC,UAAO,WAArBC,EAAAA,EAAAA,IAAyBC,EAAA,CAAAC,IAAA,KACKJ,EAAAK,WAAWC,S,WACzCf,EAAAA,EAAAA,IAUU,UAAAgB,EAAA,gBATRhB,EAAAA,EAAAA,IAQMiB,EAAAA,GAAA,MAAAC,EAAAA,EAAAA,IARaT,EAAAK,YAAPK,K,WAAZnB,EAAAA,EAAAA,IAQM,OAR0Ba,IAAKM,EAAIC,I,EACvCrB,EAAAA,EAAAA,GAGI,WAFFA,EAAAA,EAAAA,GAAuC,eAAAI,EAAAA,EAAAA,IAA3BgB,EAAIE,MAAQ,KAAH,YAAkB,KACvClB,EAAAA,EAAAA,IAAGC,EAAAC,eAAec,EAAIG,QAAU,QAAInB,EAAAA,EAAAA,IAAGC,EAAAC,eAAec,EAAII,QAAK,2BAEjEvB,EAAAA,EAAAA,IAEM,MAFNwB,EAEM,EADJzB,EAAAA,EAAAA,GAAwG,OAAnGD,OAAK2B,EAAAA,EAAAA,IAAA,CAAC,cAAa,CAAUN,EAAIO,iBAAiBC,OAAKC,EAAAA,EAAAA,IAAA,CAAAC,MAAUV,EAAIW,gBAAkB,O,eAD7DX,EAAIY,gB,WAPM,WAA/C/B,EAAAA,EAAAA,IAAuI,IAAvIgC,EAAuI,UAAtF,wBAAmBC,EAAAA,EAAAA,IAA8DC,EAAA,CAAjDC,GAAG,eAAa,C,kBAAC,IAAkB,UAAlB,yB,mCAmB9G,GACEC,KAAM,UAEPC,OACG,MAAO,CACL3B,SAAS,EACTI,WAAY,GAGhB,EAEAwB,gBACE,MAAMC,QAAgBC,KAAKC,OAAOC,SAAS,gBACrC5B,QAAmB0B,KAAKC,OAAOC,SAAS,mBAG9CF,KAAK1B,iBAAmBA,EAAW,GAAG6B,KAAIxB,IACxC,MAAMG,EAAQiB,EAAQ,GACrBK,QAAOC,GAAKA,EAAEC,aAAe3B,EAAIC,KACjCwB,QAAOC,GAAgB,YAAXA,EAAEE,OACdC,QAAO,CAACC,EAAOC,IACPD,IAAUC,EAAOC,QACvB,GAEGC,EAAU,IAAM9B,EAAQH,EAAII,MAC5BO,EAAkBsB,EAAU,IAAM,IAAMA,EACxC1B,EAAgB0B,EAAU,GAAK,QAAUA,EAAU,IAAM,SAAW,MAEpEC,EAAelC,EAAII,MAAQD,EAC3BS,EAAW,GAAEsB,EAAe,EAAI,gBAAkB,cAAcb,KAAKnC,eAAeiD,KAAKC,IAAIF,MAEnG,MAAQ,IACHlC,EACHW,kBACAJ,gBACAJ,QACAS,UACD,IAMHS,KAAK9B,SAAU,CACjB,EACA8C,WAAY,CACVC,OAAMA,EAAAA,GAERC,SAAU,KACLC,EAAAA,EAAAA,IAAW,CAAC,UAEjBC,QAAS,CAEPvD,eAAewD,EAAOC,EAAW,OAC/B,OAAO,IAAIC,KAAKC,aAAa,QAAS,CACpCrC,MAAO,WACPmC,aACCG,OAAOJ,EACZ,I,UChFJ,MAAMK,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,KAEpE,O","sources":["webpack://vue-crm/./src/views/Planning.vue","webpack://vue-crm/./src/views/Planning.vue?4d61"],"sourcesContent":["<template>\r\n    <div>\r\n            <div class=\"page-title\">\r\n              <h3>Планирование</h3>\r\n              <h4>{{ currencyFilter(info.bill) }}</h4>\r\n            </div>\r\n\r\n            <loader v-if=\"loading\" />\r\n            <p class=\"center\" v-else-if=\"!categories.length\">Категорий пока нет <router-link to=\"/categories\">Добавить категорию</router-link> </p>\r\n            <section v-else>\r\n              <div v-for=\"cat in categories\" :key=\"cat.id\">\r\n                <p>\r\n                  <strong>{{  cat.title + ':' }}</strong>\r\n                  {{ currencyFilter(cat.spend)  }} из {{ currencyFilter(cat.limit) }}\r\n                </p>\r\n                <div class=\"progress\" v-tooltip=\"cat.tooltip\">\r\n                  <div class=\"determinate\" :class=\"[cat.progressColor]\" :style=\"{width: cat.progressPercent + '%'}\"></div>\r\n                </div>\r\n              </div>\r\n            </section>\r\n          </div>\r\n</template>\r\n\r\n<script>\r\n\r\nimport Loader from '@/components/app/Loader.vue'\r\nimport { mapGetters } from 'vuex'\r\nexport default {\r\n  name: 'planing',\r\n  \r\n data() {\r\n    return {\r\n      loading: true,\r\n      categories: [],\r\n     \r\n    }\r\n  },\r\n\r\n  async mounted() {\r\n    const records = await this.$store.dispatch('fetchRecords')\r\n    const categories = await this.$store.dispatch('fetchCategories')\r\n\r\n\r\n    this.categories = await categories[0].map(cat => {\r\n      const spend = records[0]\r\n      .filter(r => r.categoryId === cat.id)\r\n      .filter(r => r.type === 'outcome')\r\n      .reduce((total, record) => {\r\n        return total += +record.amount\r\n      }, 0)\r\n\r\n      const percent = 100 * spend / cat.limit\r\n      const progressPercent = percent > 100 ? 100 : percent\r\n      const progressColor = percent < 60 ? 'green' : percent < 100 ? 'yellow' : 'red'\r\n\r\n      const tooltipValue = cat.limit - spend\r\n      const tooltip = `${tooltipValue < 0 ? 'Превышение на' : 'Осталось'} ${this.currencyFilter(Math.abs(tooltipValue))}`\r\n\r\n      return  {\r\n        ...cat,\r\n        progressPercent,\r\n        progressColor,\r\n        spend,\r\n        tooltip\r\n      }\r\n    })\r\n\r\n    // console.log(records[0]);\r\n    // console.log(categories[0]);\r\n\r\n    this.loading = false\r\n  },\r\n  components: {\r\n    Loader\r\n  },\r\n  computed: {\r\n    ...mapGetters(['info'])\r\n  },\r\n  methods: {\r\n \r\n    currencyFilter(value, currency = 'RUB') {\r\n      return new Intl.NumberFormat('ru-RU', {\r\n        style: 'currency',\r\n        currency\r\n      }).format(value)\r\n    }\r\n  }\r\n}\r\n</script>","import { render } from \"./Planning.vue?vue&type=template&id=3f9be3ad\"\nimport script from \"./Planning.vue?vue&type=script&lang=js\"\nexport * from \"./Planning.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"C:\\\\Users\\\\justi\\\\OneDrive\\\\Рабочий стол\\\\vue-crm\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["class","_createElementVNode","_createElementBlock","_hoisted_1","_hoisted_2","_toDisplayString","$options","currencyFilter","_ctx","info","bill","$data","loading","_createBlock","_component_loader","key","categories","length","_hoisted_4","_Fragment","_renderList","cat","id","title","spend","limit","_hoisted_5","_normalizeClass","progressColor","style","_normalizeStyle","width","progressPercent","tooltip","_hoisted_3","_createVNode","_component_router_link","to","name","data","async","records","this","$store","dispatch","map","filter","r","categoryId","type","reduce","total","record","amount","percent","tooltipValue","Math","abs","components","Loader","computed","mapGetters","methods","value","currency","Intl","NumberFormat","format","__exports__","render"],"sourceRoot":""}